{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  if (!gallery) {\n    console.error('Gallery element not found.');\n    return;\n  }\n\n  if (!images || images.length === 0) {\n    gallery.innerHTML = '<p class=\"no-results\">No images to display.</p>';\n    return;\n  }\n\n  const markup = images\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n      return `\n        <div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" class=\"gallery-link\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery-image\" />\n          </a>\n          <div class=\"info\">\n            <p><b>Likes:</b> ${likes}</p>\n            <p><b>Views:</b> ${views}</p>\n            <p><b>Comments:</b> ${comments}</p>\n            <p><b>Downloads:</b> ${downloads}</p>\n          </div>\n        </div>\n      `;\n    })\n    .join('');\n\n  gallery.innerHTML += markup;\n\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n","const API_KEY = import.meta.env.VITE_API_KEY;\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 12) {\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n  \n  try {\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n\n    const data = await response.json();\n\n    if (!data.hits || !data.totalHits) {\n      throw new Error('Invalid response format from API.');\n    }\n\n    return data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","import { renderGallery } from './js/render-functions.js';\nimport { fetchImages } from './js/pixabay-api.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('input[name=\"searchQuery\"]');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst perPage = 12;\nlet observer = null;\n\nform.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  const query = input.value.trim();\n  if (!query) {\n    showWarning('Please enter a search query.');\n    return;\n  }\n  if (query !== currentQuery) {\n    resetGallery();\n    currentPage = 1;\n  }\n  currentQuery = query;\n  try {\n    toggleLoader(true);\n    const { hits, totalHits } = await fetchImages(query, currentPage, perPage);\n    if (!hits || hits.length === 0) {\n      showWarning('No images found for your query. Try again!');\n      return;\n    }\n    if (currentPage === 1) showSuccess(`Found ${totalHits} images!`);\n    renderGallery(hits);\n    setupInfiniteScroll(totalHits);\n  } catch (error) {\n    showError(error.message || 'Something went wrong. Please try again later.');\n  } finally {\n    toggleLoader(false);\n  }\n}\n\nfunction resetGallery() {\n  gallery.innerHTML = '';\n  removeSentinel();\n}\n\nfunction toggleLoader(show) {\n  loader.style.display = show ? 'block' : 'none';\n}\n\nfunction showWarning(message) {\n  iziToast.warning({ title: 'Warning', message, position: 'topRight' });\n}\n\nfunction showSuccess(message) {\n  iziToast.success({ title: 'Success', message, position: 'topRight' });\n}\n\nfunction showError(message) {\n  iziToast.error({ title: 'Error', message, position: 'topRight' });\n}\n\nfunction setupInfiniteScroll(totalHits) {\n  if (observer) observer.disconnect();\n  const sentinel = createSentinel();\n  observer = new IntersectionObserver(async (entries) => {\n    if (entries[0].isIntersecting) {\n      if (currentPage * perPage >= totalHits) {\n        showWarning('You have reached the end of the results.');\n        observer.disconnect();\n        return;\n      }\n      currentPage++;\n      toggleLoader(true);\n      try {\n        const { hits } = await fetchImages(currentQuery, currentPage, perPage);\n        renderGallery(hits);\n      } catch (error) {\n        showError('Error loading more images.');\n      } finally {\n        toggleLoader(false);\n      }\n    }\n  }, { threshold: 1.0 });\n  observer.observe(sentinel);\n}\n\nfunction createSentinel() {\n  let sentinel = document.querySelector('.sentinel');\n  if (!sentinel) {\n    sentinel = document.createElement('div');\n    sentinel.classList.add('sentinel');\n    gallery.after(sentinel);\n  }\n  return sentinel;\n}\n\nfunction removeSentinel() {\n  const sentinel = document.querySelector('.sentinel');\n  if (sentinel) sentinel.remove();\n}\n"],"names":["renderGallery","images","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","API_KEY","BASE_URL","fetchImages","query","page","perPage","url","response","data","error","form","input","loader","currentPage","currentQuery","observer","onSearch","event","showWarning","resetGallery","toggleLoader","hits","totalHits","showSuccess","setupInfiniteScroll","showError","removeSentinel","show","message","iziToast","sentinel","createSentinel","entries"],"mappings":"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"}